/* --- VARIABLES & RESET --- */
:root {
    --primary-blue: #4facfe;
    --secondary-pink: #ff4757;
    --tertiary-orange: #ff9f43;
    --dark-ui: #2f3640;
    --ground-color: #2ecc71;
    --font-title: 'Fredoka One', cursive;
    --font-body: 'Montserrat', sans-serif;
}

* { box-sizing: border-box; margin: 0; padding: 0; }
body { background: var(--dark-ui); font-family: var(--font-body); }
/* Utility class to hide elements smoothly */
.hidden-fade { opacity: 0; visibility: hidden; transition: all 0.5s ease-out; height: 0; padding: 0 !important; overflow: hidden;}


/* --- GAME CONTAINER & SKY --- */
#game-container {
    position: relative;
    width: 100%;
    height: 450px; 
    overflow: hidden;
    border-bottom: 8px solid #27ae60;
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    /* Ensure game stays on top of intro section during transition */
    z-index: 10; 
}

/* Parallax Layers */
.bg-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-repeat: repeat-x; will-change: background-position; }
.sky-gradient { background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%); }
.clouds-back { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 200" opacity="0.4"><path fill="white" d="M128,114 Q150,80 199,101 Q250,60 300,110 Q400,90 420,130 L120,130 Z M600,100 Q650,50 700,110 Q750,80 800,120 L580,120 Z" /></svg>'); background-position: top center; background-size: 1000px 200px; }
.mountains { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 300" preserveAspectRatio="none"><path d="M0,300 L100,200 L250,280 L400,150 L600,290 L850,120 L1200,300 Z" fill="%233742fa" opacity="0.3"/></svg>'); background-size: 1200px 300px; background-position: bottom left; }
.ground-track { height: 50px; bottom: 0; top: auto; background: var(--ground-color); background-image: repeating-linear-gradient(90deg, transparent 0, transparent 50px, rgba(255,255,255,0.2) 50px, rgba(255,255,255,0.2) 100px); border-top: 5px solid #27ae60; }

/* --- FINISH LINE --- */
#finish-line { position: absolute; right: -150px; top: 0; height: 100%; width: 80px; display: flex; flex-direction: column; justify-content: center; z-index: 5; filter: drop-shadow(-5px 0 5px rgba(0,0,0,0.2)); }
.checkers { height: 100%; background-color: #eee; background-image: linear-gradient(45deg, #000 25%, transparent 25%, transparent 75%, #000 75%, #000), linear-gradient(45deg, #000 25%, transparent 25%, transparent 75%, #000 75%, #000); background-size: 40px 40px; background-position: 0 0, 20px 20px; border-left: 5px solid white; }
#finish-line span { position: absolute; left: -40px; top: 50%; transform: translateY(-50%) rotate(-90deg); background: #ff4757; color: white; font-family: var(--font-title); padding: 5px 15px; border-radius: 5px; letter-spacing: 2px; box-shadow: 3px 3px 0 #c0392b; }

/* --- PLAYERS & CHARACTERS --- */
.player-wrapper { position: absolute; left: 50px; z-index: 10; transition: left 0.1s linear; }
.player-tag { position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.6); color: white; font-size: 10px; font-weight: 700; padding: 2px 8px; border-radius: 10px; white-space: nowrap; }
.dust-trail { position: absolute; bottom: 5px; left: -20px; width: 40px; height: 20px; background: radial-gradient(circle, rgba(255,255,255,0.6) 0%, rgba(255,255,255,0) 70%); opacity: 0; border-radius: 50%; filter: blur(5px); }
body.running .dust-trail { animation: dustPuff 0.6s infinite; }
@keyframes dustPuff { 0% { opacity: 0; transform: scale(0.5) translateX(0); } 50% { opacity: 0.8; } 100% { opacity: 0; transform: scale(1.5) translateX(-30px); } }

/* BASE CHARACTER STYLE */
.character { width: 60px; height: 60px; border-radius: 14px; position: relative; box-shadow: 0 8px 10px rgba(0,0,0,0.2); }
/* Only bouncy when running, not in intro */
body.running .character:not(.static-pose) { animation: bouncyRun 0.5s infinite alternate ease-in-out; }
/* Static pose for intro section */
.static-pose { transform: scale(1.2); box-shadow: none; }

@keyframes bouncyRun { from { transform: translateY(0) scale(1); } to { transform: translateY(-12px) scale(1.05, 0.95); } }

/* Character Details */
.char-blue { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-bottom: 5px solid #2980b9; }
.goggles { position: absolute; top: 15px; left: 5px; width: 50px; height: 20px; background: #333; border-radius: 10px; border: 2px solid #555; }
.lens { width: 100%; height: 100%; background: linear-gradient(to bottom, #bdc3c7, #2c3e50); border-radius: 8px; overflow: hidden; }
.lens::after { content:''; position: absolute; top: 2px; left: 5px; width: 15px; height: 5px; background: rgba(255,255,255,0.7); border-radius: 10px; transform: rotate(-20deg);}
.char-pink { background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%); border-bottom: 5px solid #e84393; border-radius: 50% 50% 20% 20%; }
.big-eye { position: absolute; top: 15px; left: 50%; transform: translateX(-50%); width: 30px; height: 30px; background: white; border-radius: 50%; border: 3px solid #333; }
.big-eye::after { content:''; position: absolute; top: 5px; left: 5px; width: 12px; height: 12px; background: #333; border-radius: 50%; animation: blink 3s infinite; }
.smile { position: absolute; bottom: 12px; left: 50%; transform: translateX(-50%); width: 20px; height: 8px; border-bottom: 3px solid #333; border-radius: 50%; }
.char-orange { background: linear-gradient(135deg, #f0932b 0%, #ffbe76 100%); border-bottom: 5px solid #d35400; }
.fox-ears { position: absolute; top: -10px; width: 100%; height: 20px; }
.fox-ears::before, .fox-ears::after { content:''; position: absolute; width: 0; height: 0; border-left: 12px solid transparent; border-right: 12px solid transparent; border-bottom: 20px solid #f0932b; }
.fox-ears::before { left: 5px; } .fox-ears::after { right: 5px; }
.fox-face { position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); width: 30px; height: 20px; background: #ffeaa7; border-radius: 10px 10px 20px 20px; }
.fox-nose { position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); width: 8px; height: 6px; background: #333; border-radius: 50%; }
@keyframes blink { 0%, 90%, 100% { transform: scaleY(1); } 95% { transform: scaleY(0.1); } }

/* --- UI OVERLAY --- */
.glass-panel { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(47, 54, 64, 0.7); backdrop-filter: blur(5px); display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; z-index: 100; transition: opacity 0.5s; }
.glass-panel h1 { font-family: var(--font-title); font-size: 48px; color: #f1c40f; text-shadow: 4px 4px 0 #e67e22, 0 0 20px rgba(241, 196, 15, 0.5); margin-bottom: 10px; transform: rotate(-3deg); }
.arcade-btn { margin-top: 25px; padding: 15px 40px; font-family: var(--font-title); font-size: 24px; color: white; background: var(--ground-color); border: none; border-radius: 12px; box-shadow: 0 8px 0 #219653, 0 15px 20px rgba(0,0,0,0.3); cursor: pointer; transition: all 0.1s; }
.arcade-btn:active { transform: translateY(8px); box-shadow: 0 0 0 #219653, 0 5px 10px rgba(0,0,0,0.2); }
.arrow { display: inline-block; transition: transform 0.3s; }
.arcade-btn:hover .arrow { transform: translateX(5px); }
.arcade-btn.small { font-size: 18px; padding: 10px 25px; box-shadow: 0 5px 0 #219653; }

/* ========================================= */
/* --- NEW SECTION: CHARACTER INTRO CSS --- */
/* ========================================= */
#character-intro {
    text-align: center;
    padding: 40px 20px;
    color: white;
    /* Background matches body color to blend into the "blank space" */
    background: var(--dark-ui); 
    transition: all 0.5s ease-out;
}
#character-intro h2 { font-family: var(--font-title); margin-bottom: 30px; color: #f1c40f; letter-spacing: 1px; }
.intro-grid { display: flex; justify-content: center; gap: 25px; flex-wrap: wrap; }

.intro-card {
    background: rgba(255,255,255,0.05); /* Subtle transparent card */
    border-radius: 15px;
    padding: 25px 20px;
    width: 220px;
    text-align: center;
    border-top: 5px solid #ccc;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}
/* Card top border colors */
.intro-card.blue-border { border-color: var(--primary-blue); }
.intro-card.pink-border { border-color: var(--secondary-pink); }
.intro-card.orange-border { border-color: var(--tertiary-orange); }

.preview-box { height: 80px; display: flex; justify-content: center; align-items: center; margin-bottom: 20px; }
.intro-card h3 { font-family: var(--font-body); font-weight: 700; margin-bottom: 5px; font-size: 1.2em;}
.intro-card p { font-size: 0.9em; color: #aaa; font-weight: 400;}

/* ========================================= */


/* --- LEADERBOARD --- */
#leaderboard { padding: 40px 20px; text-align: center; color: white; background: var(--dark-ui); min-height: 400px; transition: all 0.5s ease-in-out;}
#leaderboard h2 { font-family: var(--font-title); margin-bottom: 30px; letter-spacing: 2px; }
#leaderboard.hidden { display: none; }
.results-card { background: #fff; color: var(--dark-ui); margin: 15px auto; padding: 20px; max-width: 600px; border-radius: 15px; text-align: left; box-shadow: 0 10px 25px rgba(0,0,0,0.1); display: flex; align-items: center; border-left: 12px solid #333; animation: slideUp 0.5s ease-out forwards; opacity: 0; transform: translateY(30px); }
@keyframes slideUp { to { opacity: 1; transform: translateY(0); } }
.rank-badge { font-size: 2.5em; margin-right: 20px; filter: drop-shadow(0 3px 3px rgba(0,0,0,0.3)); }
.card-info h3 { font-family: var(--font-body); font-weight: 800; margin-bottom: 5px; }
.card-info p { font-size: 0.9em; line-height: 1.4; color: #666; }
.runner-id { color: var(--primary-blue); font-weight: 700; font-size: 0.85em; text-transform: uppercase; letter-spacing: 1px;}
.results-card.rank-1 { border-color: #f1c40f; background: linear-gradient(to right, #fff, #fffbf0); }
.results-card.rank-2 { border-color: #95a5a6; }
.results-card.rank-3 { border-color: #d35400; }