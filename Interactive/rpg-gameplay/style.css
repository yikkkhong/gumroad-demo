:root {
    --tile-size: 48px;
    --bg-grass: #56bc64;
    --bg-water: #4da6ff;
    --bg-bridge: #d3b582;
    --ui-bg: #222;
    --accent: #f1c40f;
    --font: 'Press Start 2P', cursive;
}

body {
    margin: 0; overflow: hidden; background: #111;
    font-family: var(--font); color: white;
}

/* --- MAP --- */
#camera { width: 100vw; height: 100vh; overflow: hidden; position: relative; background: var(--bg-water); }
#world-map { position: absolute; top: 0; left: 0; transition: transform 0.2s ease-out; }

.tile { width: var(--tile-size); height: var(--tile-size); position: absolute; box-sizing: border-box; }
.grass { background: var(--bg-grass); box-shadow: inset 0 -4px rgba(0,0,0,0.1); }
.water { background: var(--bg-water); opacity: 0.9; animation: wave 3s infinite linear;}
.bridge { background: var(--bg-bridge); border-top: 2px solid #a88d60; border-bottom: 2px solid #a88d60; }

@keyframes wave { 0% { opacity: 0.9; } 50% { opacity: 0.7; } 100% { opacity: 0.9; } }

/* --- OBJECTS --- */
.tree { background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M50 10 L10 70 L90 70 Z" fill="%232d6a4f"/><rect x="40" y="70" width="20" height="30" fill="%235c4033"/></svg>') no-repeat center bottom; background-size: contain; z-index: 5;}
.chest { background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><rect x="10" y="30" width="80" height="50" fill="%23f39c12" stroke="black" stroke-width="4"/><rect x="40" y="50" width="20" height="10" fill="black"/></svg>') no-repeat center; z-index: 2; }
.slime { background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M20 80 Q20 30 50 30 Q80 30 80 80 Z" fill="%23e74c3c" stroke="black" stroke-width="3"/><circle cx="35" cy="55" r="5" fill="white"/><circle cx="65" cy="55" r="5" fill="white"/></svg>') no-repeat bottom; background-size: 80%; z-index: 3; animation: bounce 1s infinite; }
.sign { background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><rect x="10" y="20" width="80" height="50" fill="%23e67e22" stroke="white" stroke-width="3"/><rect x="45" y="70" width="10" height="20" fill="brown"/><text x="50" y="55" font-family="monospace" font-size="20" text-anchor="middle" fill="white">!</text></svg>') no-repeat center; z-index: 2; }

/* THE HOLY SWORD */
.holy-sword {
    background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M45 80 L55 80 L55 20 L45 20 Z" fill="silver" stroke="black"/><path d="M30 70 L70 70 L70 80 L30 80 Z" fill="gold" stroke="black"/><circle cx="50" cy="75" r="5" fill="red"/></svg>') no-repeat center;
    z-index: 4;
    animation: floatGlow 1.5s infinite ease-in-out;
    filter: drop-shadow(0 0 10px gold);
}
@keyframes floatGlow {
    0%, 100% { transform: translateY(0) scale(1); filter: drop-shadow(0 0 5px gold); }
    50% { transform: translateY(-10px) scale(1.1); filter: drop-shadow(0 0 15px gold); }
}

.boss { 
    background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M20 20 L40 50 L60 50 L80 20 L70 90 L30 90 Z" fill="%238e44ad" stroke="black" stroke-width="3"/><circle cx="40" cy="60" r="5" fill="yellow"/><circle cx="60" cy="60" r="5" fill="yellow"/><path d="M30 80 L70 80" stroke="black" stroke-width="3"/></svg>') no-repeat center; 
    background-size: 100%; z-index: 4; width: 48px; height: 48px;
    transform: scale(2.5); transform-origin: bottom center;
}

/* --- HERO DESIGN (NEW!) --- */
#hero {
    width: var(--tile-size); height: var(--tile-size);
    position: absolute; z-index: 10;
    transition: top 0.1s, left 0.1s;
    /* Pixel Art Hero: Blue Armor/Hoodie, Skin face, Black legs */
    background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges"><rect x="6" y="2" width="12" height="10" fill="%232980b9"/><rect x="8" y="6" width="8" height="4" fill="%23f1c40f"/><rect x="6" y="12" width="12" height="6" fill="%233498db"/><rect x="8" y="18" width="3" height="4" fill="black"/><rect x="13" y="18" width="3" height="4" fill="black"/></svg>') no-repeat center;
    background-size: 100%;
    animation: idle 1s infinite alternate;
}

@keyframes idle {
    0% { transform: translateY(0); }
    100% { transform: translateY(-3px); }
}

/* --- UI --- */
.hidden { display: none !important; }
.hud { position: fixed; top: 0; left: 0; padding: 20px; z-index: 20; text-shadow: 2px 2px #000; }
#quest-log { margin-top: 10px; color: var(--accent); font-size: 0.8rem; }

#dialogue-box {
    position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
    width: 80%; background: var(--ui-bg); border: 4px solid #fff;
    padding: 20px; z-index: 100; text-align: center;
    box-shadow: 0 0 20px #000;
}
.reward-text { color: var(--accent); margin-top: 10px; font-weight: bold; }
button { background: var(--accent); border: none; padding: 10px 20px; font-family: inherit; cursor: pointer; margin-top: 10px; font-weight: bold;}

/* --- BATTLE SCREEN --- */
#battle-screen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #1a1a1a; z-index: 200;
    display: flex; flex-direction: column;
}
.battle-arena {
    flex: 2; position: relative;
    background: linear-gradient(to bottom, #2c3e50, #000);
    display: flex; justify-content: space-evenly; align-items: center; /* Centered Alignment */
}
.enemy-zone, .player-zone { display: flex; flex-direction: column; align-items: center; gap: 15px; width: 200px; }

#enemy-sprite { width: 120px; height: 120px; background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M20 80 Q20 30 50 30 Q80 30 80 80 Z" fill="%23e74c3c" stroke="black" stroke-width="3"/><circle cx="35" cy="55" r="5" fill="white"/><circle cx="65" cy="55" r="5" fill="white"/></svg>') no-repeat center; background-size: contain; transition: 0.2s; }
#enemy-sprite.boss-mode {
     background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M20 20 L40 50 L60 50 L80 20 L70 90 L30 90 Z" fill="%238e44ad" stroke="black" stroke-width="3"/><circle cx="40" cy="60" r="5" fill="yellow"/><circle cx="60" cy="60" r="5" fill="yellow"/><path d="M30 80 L70 80" stroke="black" stroke-width="3"/></svg>') no-repeat center; 
     transform: scale(2.2);
}

/* BATTLE HERO (NEW!) - Bigger, holding a sword */
#hero-battle-sprite { 
    width: 120px; height: 120px; 
    /* Detailed Pixel Warrior for Battle */
    background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges"><rect x="6" y="2" width="12" height="10" fill="%232980b9"/><rect x="8" y="6" width="8" height="4" fill="%23f1c40f"/><rect x="6" y="12" width="12" height="6" fill="%233498db"/><rect x="8" y="18" width="3" height="4" fill="black"/><rect x="13" y="18" width="3" height="4" fill="black"/><rect x="18" y="10" width="2" height="10" fill="silver"/><rect x="16" y="16" width="6" height="2" fill="grey"/></svg>') no-repeat center; 
    background-size: contain;
}

.hp-box { background: #333; padding: 5px; border: 2px solid #fff; color: #fff; font-size: 0.7rem; width: 100%; text-align: left;}
.hp-bar-bg { width: 100%; height: 10px; background: #555; margin-top: 5px; }
.hp-fill { width: 100%; height: 100%; background: #2ecc71; transition: width 0.3s; }

.battle-menu { flex: 1; border-top: 4px solid #fff; background: #222; padding: 20px; display: flex; gap: 20px; }
#combat-log { flex: 1; border: 2px dashed #444; padding: 10px; font-size: 0.8rem; line-height: 1.5; color: #ccc; }
.action-buttons { flex: 1; display: flex; flex-direction: column; gap: 10px; }
.skill-btn { background: #8e44ad; color: white; padding: 8px; border: 1px solid #fff; cursor: pointer;}

/* Secret Skill Button */
.secret-btn {
    background: linear-gradient(90deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);
    background-size: 200% 200%;
    animation: rainbow 2s ease infinite;
    border: 2px solid #fff;
    color: white; font-weight: bold; text-shadow: 2px 2px 0 #000;
}
@keyframes rainbow { 0% {background-position: 0% 50%} 50% {background-position: 100% 50%} 100% {background-position: 0% 50%} }
.shake { animation: shake 0.5s; }
@keyframes shake { 0% { transform: translate(0,0); } 25% { transform: translate(-10px,0); } 75% { transform: translate(10px,0); } 100% { transform: translate(0,0); } }